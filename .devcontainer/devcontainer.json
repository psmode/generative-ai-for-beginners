// Lightweight devcontainer with Python 3.11 preinstalled (no Conda layer)
// This avoids the "no space left on device" error seen with the universal image + features.
{
  "name": "Generative AI For Beginners",
  "image": "mcr.microsoft.com/devcontainers/python:3.11-bookworm",

  // Keep the same machine request
  "hostRequirements": { "cpus": 4 },

  "waitFor": "onCreateCommand",

  // Speed + reliability: no cache, upgrade packaging tools, then your installs
  "updateContentCommand": "env PIP_NO_CACHE_DIR=1 python -m pip install --upgrade pip setuptools wheel && python -m pip install -r requirements.txt",

  "postCreateCommand": "bash .devcontainer/post-create.sh",

  "customizations": {
    "codespaces": { "openFiles": [] },
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-toolsai.jupyter"
      ],
      // Keep rustup if you truly need it, but minimize footprint
      "postCreateCommand": [
        "bash -lc \"command -v rustup >/dev/null || curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --profile minimal\"",
        "python -m pip --disable-pip-version-check --no-cache-dir install -r requirements.txt"
      ]
    }
  }
}
